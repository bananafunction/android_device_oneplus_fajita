From e42af38553fc474c4c3b35122ccf85f2aadc45f1 Mon Sep 17 00:00:00 2001
From: Dyneteve <dyneteve@hentaios.com>
Date: Sun, 31 Jan 2021 02:19:54 +0900
Subject: [PATCH] KeyStore: Report rate limited instead of not implemented

Signed-off-by: Anushek Prasal <anushekprasal@gmail.com>
---
 keystore/java/android/security/KeyStore.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/keystore/java/android/security/KeyStore.java b/keystore/java/android/security/KeyStore.java
index 0f766ef738b..b89adedb5e8 100644
--- a/keystore/java/android/security/KeyStore.java
+++ b/keystore/java/android/security/KeyStore.java
@@ -1126,7 +1126,7 @@ public class KeyStore {
             String alias, KeymasterArguments params, KeymasterCertificateChain outChain) {
         // Prevent Google Play Services from using key attestation for SafetyNet
         if (mContext.getPackageName().equals("com.google.android.gms")) {
-            return KeymasterDefs.KM_ERROR_UNIMPLEMENTED;
+            return KeymasterDefs.KM_ERROR_KEY_RATE_LIMIT_EXCEEDED;
         }
 
         CertificateChainPromise promise = new CertificateChainPromise();
-- 
2.25.1

